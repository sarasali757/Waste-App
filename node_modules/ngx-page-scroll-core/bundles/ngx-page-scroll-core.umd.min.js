!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core")):"function"==typeof define&&define.amd?define("ngx-page-scroll-core",["exports","@angular/core"],e):e((t=t||self)["ngx-page-scroll-core"]={},t.ng.core)}(this,(function(t,e){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var o=function(){return(o=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var r in e=arguments[o])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function n(t,e,o,n){var r,i=arguments.length,l=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(l=(i<3?r(l):i>3?r(e,o,l):r(e,o))||l);return i>3&&l&&Object.defineProperty(e,o,l),l}function r(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}var i=function(){function t(t){this.startScrollPosition=0,this.interruptListenersAttached=!1,this.timer=null,t.scrollViews&&0!==t.scrollViews.length?this.isInlineScrolling=!0:(t.scrollViews=[t.document.documentElement,t.document.body,t.document.body.parentNode],this.isInlineScrolling=!1),this.pageScrollOptions=t}return t.getScrollingTargetPosition=function(t,e){var o=t.document.body,n=t.document.documentElement,r=t.document.defaultView&&t.document.defaultView.pageYOffset||void 0,i=t.document.defaultView&&t.document.defaultView.pageXOffset||void 0,l=r||n.scrollTop||o.scrollTop,s=i||n.scrollLeft||o.scrollLeft,c=n.clientTop||o.clientTop||0,a=n.clientLeft||o.clientLeft||0;if(null==e)return{top:l,left:s};var p=e.getBoundingClientRect(),u=p.top+l-c,g=p.left+s-a;return{top:Math.round(u),left:Math.round(g)}},t.getInlineScrollingTargetPosition=function(t,e){var o={top:e.offsetTop,left:e.offsetLeft};if(t.advancedInlineOffsetCalculation&&1===t.scrollViews.length){for(var n={top:0,left:0},r=e.ownerDocument.defaultView,i=!1,l=e.parentElement;!i&&null!=l;)"relative"===r.getComputedStyle(l).getPropertyValue("position")&&(n.top+=l.offsetTop,n.left+=l.offsetLeft),i=(l=l.parentElement)===t.scrollViews[0];i&&(o.top+=n.top,o.left+=n.left)}return o},t.prototype.getScrollPropertyValue=function(t){return this.pageScrollOptions.verticalScrolling?t.scrollTop:t.scrollLeft},t.prototype.getScrollClientPropertyValue=function(t){return this.pageScrollOptions.verticalScrolling?t.clientHeight:t.clientWidth},t.prototype.extractScrollTargetPosition=function(){var e=this.getScrollTargetElement();return null==e?{top:NaN,left:NaN}:this.isInlineScrolling?t.getInlineScrollingTargetPosition(this.pageScrollOptions,e):t.getScrollingTargetPosition(this.pageScrollOptions,e)},t.prototype.getCurrentOffset=function(){return this.pageScrollOptions.scrollOffset},t.prototype.setScrollPosition=function(t){var e=this;return this.pageScrollOptions.scrollViews.reduce((function(o,n){var r=e.getScrollPropertyValue(n);if(n&&null!=r){var i=Math.abs(r-t),l=i<e.pageScrollOptions._minScrollDistance;if(e.pageScrollOptions.verticalScrolling?n.scrollTop=t:n.scrollLeft=t,l||i>Math.abs(e.getScrollPropertyValue(n)-t))return!0}return o}),!1)},t.prototype.fireEvent=function(t){this.pageScrollOptions.scrollFinishListener&&this.pageScrollOptions.scrollFinishListener.emit(t)},t.prototype.attachInterruptListeners=function(t){var e=this;this.interruptListenersAttached&&this.detachInterruptListeners(),this.interruptListener=function(o){t.report(o,e)},this.pageScrollOptions.interruptEvents.forEach((function(t){return e.pageScrollOptions.document.body.addEventListener(t,e.interruptListener)})),this.interruptListenersAttached=!0},t.prototype.detachInterruptListeners=function(){var t=this;this.pageScrollOptions.interruptEvents.forEach((function(e){return t.pageScrollOptions.document.body.removeEventListener(e,t.interruptListener)})),this.interruptListenersAttached=!1},t.prototype.getScrollTargetElement=function(){if("string"==typeof this.pageScrollOptions.scrollTarget){var t=this.pageScrollOptions.scrollTarget;return null!==t.match(/^#[^\s]+$/g)?this.pageScrollOptions.document.getElementById(t.substr(1)):this.pageScrollOptions.document.querySelector(t)}return this.pageScrollOptions.scrollTarget},t}(),l=new e.InjectionToken("ngxps_config"),s={_interval:10,_minScrollDistance:2,_logLevel:1,namespace:"default",verticalScrolling:!0,duration:1250,scrollOffset:0,advancedInlineOffsetCalculation:!1,interruptEvents:["mousedown","wheel","DOMMouseScroll","mousewheel","keyup","touchmove"],interruptKeys:[" ","Escape","Tab","Enter","PageUp","PageDown","Home","End","ArrowUp","ArrowRight","ArrowLeft","ArrowDown"],interruptible:!0,scrollInView:!0,easingLogic:function(t,e,o,n){return o*t/n+e}},c=function(){function t(t){var n=this;this.runningInstances=[],this.onInterrupted={report:function(t,e){if(e.pageScrollOptions.interruptible){var o=!0;"keyup"===t.type?-1===n.config.interruptKeys.indexOf(t.key)&&(o=!1):"mousedown"===t.type&&(e.pageScrollOptions.scrollViews.some((function(e){return e.contains(t.target)}))||(o=!1)),o&&n.stopAll(e.pageScrollOptions.namespace)}}},this.config=o(o({},s),t),c.instanceCounter>0&&(this.config._logLevel>=2||this.config._logLevel>=1&&e.isDevMode())&&console.warn("An instance of PageScrollService already exists, usually including one provider should be enough, so double check."),c.instanceCounter++}var c,a,p;return c=t,t.prototype.stopInternal=function(t,e){var o=this.runningInstances.indexOf(e);return o>=0&&this.runningInstances.splice(o,1),e.interruptListenersAttached&&e.detachInterruptListeners(),!!e.timer&&(clearInterval(e.timer),e.timer=void 0,e.fireEvent(!t),!0)},t.prototype.create=function(t){return new i(o(o({},this.config),t))},t.prototype.start=function(t){var n=this;if(t.pageScrollOptions=o(o({},this.config),t.pageScrollOptions),this.stopAll(t.pageScrollOptions.namespace),null!==t.pageScrollOptions.scrollViews&&0!==t.pageScrollOptions.scrollViews.length){var r=!1,i=t.getScrollClientPropertyValue(t.pageScrollOptions.scrollViews[0]);t.startScrollPosition=0,t.pageScrollOptions.scrollViews.forEach((function(e){if(null!=e){var o=t.getScrollPropertyValue(e);!r&&o&&(t.startScrollPosition=o,r=!0,i=t.getScrollClientPropertyValue(e))}}));var l=t.getCurrentOffset(),s=t.extractScrollTargetPosition();if(t.targetScrollPosition=Math.round((t.pageScrollOptions.verticalScrolling?s.top:s.left)-l),t.distanceToScroll=t.targetScrollPosition-t.startScrollPosition,isNaN(t.distanceToScroll))return(this.config._logLevel>=2||this.config._logLevel>=1&&e.isDevMode())&&console.log("Scrolling not possible, as we can't find the specified target"),void t.fireEvent(!1);var c=Math.abs(t.distanceToScroll)<t.pageScrollOptions._minScrollDistance;t.executionDuration=t.pageScrollOptions.duration,void 0===t.pageScrollOptions.speed||null===t.pageScrollOptions.speed||void 0!==t.pageScrollOptions.duration&&null!==t.pageScrollOptions.duration||(t.executionDuration=Math.abs(t.distanceToScroll)/t.pageScrollOptions.speed*1e3);var a=t.executionDuration<=t.pageScrollOptions._interval;if(c||a)return(this.config._logLevel>=2||this.config._logLevel>=1&&e.isDevMode())&&(c?console.log("Scrolling not possible, as we can't get any closer to the destination"):console.log("Scroll duration shorter that interval length, jumping to target")),t.setScrollPosition(t.targetScrollPosition),void t.fireEvent(!0);if(!t.pageScrollOptions.scrollInView)if(t.targetScrollPosition>t.startScrollPosition&&t.targetScrollPosition<=t.startScrollPosition+i)return(this.config._logLevel>=2||this.config._logLevel>=1&&e.isDevMode())&&console.log("Not scrolling, as target already in view"),void t.fireEvent(!0);t.pageScrollOptions.interruptible&&t.attachInterruptListeners(this.onInterrupted),t.startTime=(new Date).getTime(),t.endTime=t.startTime+t.executionDuration,t.timer=setInterval((function(t){var o,r=(new Date).getTime(),i=!1;t.endTime<=r?(o=t.targetScrollPosition,i=!0):o=Math.round(t.pageScrollOptions.easingLogic(r-t.startTime,t.startScrollPosition,t.distanceToScroll,t.executionDuration)),n.config._logLevel>=5&&e.isDevMode()&&console.warn("Scroll Position: "+o),t.setScrollPosition(o)||(i=!0),i&&n.stopInternal(!1,t)}),this.config._interval,t),this.runningInstances.push(t)}else(this.config._logLevel>=2||this.config._logLevel>=1&&e.isDevMode())&&console.warn("No scrollViews specified, thus ngx-page-scroll does not know which DOM elements to scroll")},t.prototype.scroll=function(t){this.start(this.create(t))},t.prototype.stopAll=function(t){if(this.runningInstances.length>0){for(var e=!1,o=0;o<this.runningInstances.length;++o){var n=this.runningInstances[o];t&&n.pageScrollOptions.namespace!==t||(e=!0,this.stopInternal(!0,n),o--)}return e}return!1},t.prototype.stop=function(t){return this.stopInternal(!0,t)},t.instanceCounter=0,t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:[l]}]}]},t.ɵprov=e["ɵɵdefineInjectable"]({factory:function(){return new t(e["ɵɵinject"](l))},token:t,providedIn:"root"}),t=c=n([e.Injectable({providedIn:"root"}),(a=0,p=e.Inject(l),function(t,e){p(t,e,a)}),r("design:paramtypes",[Object])],t)}(),a={},p=function(){function t(){}var o;return o=t,t.forRoot=function(t){return{ngModule:o,providers:[c,{provide:l,useValue:t}]}},t=o=n([e.NgModule({providers:[c,{provide:l,useValue:a}]})],t)}();t.NGXPS_CONFIG=l,t.NgxPageScrollCoreModule=p,t.PageScrollInstance=i,t.PageScrollService=c,t.defaultPageScrollConfig=s,t.ɵ0=a,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-page-scroll-core.umd.min.js.map